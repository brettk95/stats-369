bike_files = list.files(path = "." ,pattern=".csv",full=TRUE)
bike_data = map(bike_files,read_csv)
notallNA<-function(x) !all(is.na(x))
bike_data <- map(bike_data, select_if, notallNA)
bike_tidy<-map(bike_data, gather, value="rider_count", key="counter", -Date)
allbikes<-bind_rows(bike_tidy)
rain_data = map(rain_files, read_delim(sep = ','))
rain_data = map(rain_files, read.delim(sep = ','))
rain_data = map(rain_files, read.tabl(sep = ','))
rain_data = map(rain_files, read.table(sep = ','))
rain_data_all = bind_rows(rain_data) %>% filter(!is.na(Station))
rain_data = map(rain_files, read_delim(sep = ','))
rain_data_all = bind_rows(rain_data) %>% filter(!is.na(Station))
# Read in rain data
rain_files = list.files(path = '.', pattern = '.txt', full = TRUE)
rain_data = map(rain_files, read_delim(sep = ','))
rain_data = map(rain_files, read_delim)
rain_data = map(rain_files, read_delim(,))
rain_data = map(rain_files, read_delim(','))
rain_data = map(rain_files, read_delim(sep = ','))
help("read_delim")
rain_data = map(rain_files, read_delim(delim = ','))
# Read in rain data
rain_files = list.files(path = '.', pattern = '.txt', full = TRUE)
rain_data = map(rain_files, read_delim(delim = ','))
rain_data = map(rain_files, read_delim)
rain_data = map(rain_files, read_delim(sep = ','))
rain_files = list.files(path = '.', pattern = '.txt', full = TRUE)
rain_data = map(rain_files, read_delim(sep = ','))
rain_data = map(rain_files, read_delim(sep = ","))
setwd("~/github/stats-369/assignments/assignment-1")
# Read in rain data
rain_files = list.files(path = '.', pattern = '.txt', full = TRUE)
rain_data = map(rain_files, read_delim(sep = ","))
rain_data = map(rain_files, read_delim(delim = ","))
rain_data = map(rain_files, read_delim(rain_files, delim = ","))
rain_data = map(read_delim(rain_files, delim = ","))
# Read in rain data
rain_files = list.files(path = '.', pattern = '.txt', full = TRUE)
rain_data = map(rain_files, read_csv)
View(rain_data)
View(rain_data)
rain_data = bind_rows(rain_data)
View(rain_data)
rain_data = bind_rows(rain_data)[c(-5,-6)]
View(rain_data)
View(rain_data)
View(allbikes)
allbikes %>% group_by(counter) %>% summarise(totals = sum(rider_count)) %>% arrange(desc(totals))
allbikes %>% group_by(Day, counter) %>% summarise(totals = sum(rider_count)) %>% arrange(desc(totals))
allbikes %>% group_by(Date, counter) %>% summarise(totals = sum(rider_count)) %>% arrange(desc(totals))
allbikes %>% group_by(Date, counter) %>% summarise(totals = sum(rider_count)) %>% arrange(desc(totals)) %>% View()
allbikes %>% filter(is.na(Date))
allbikes = allbikes %>% filter(!is.na(Date))
allbikes %>% group_by(Date, counter) %>% summarise(totals = sum(rider_count)) %>% arrange(desc(totals)) %>% View()
allbikes = allbikes %>% filter(!is.na(Date))
x = allbikes %>% seperate(Date, c("Day", "Date", "Month", "Year"))
x = allbikes %>% separate(Date, c("Day", "Date", "Month", "Year"))
View(x)
map(x, {'Jan':01, 'Feb':02, 'Mar':03, 'Apr':04, 'May':05, 'Jun':06, 'Jul':07, 'Aug':08, 'Sep':09, 'Oct':10, 'Nov':11, 'Dec':12})
x = map(x$Date, {'Jan':01, 'Feb':02, 'Mar':03, 'Apr':04, 'May':05, 'Jun':06, 'Jul':07, 'Aug':08, 'Sep':09, 'Oct':10, 'Nov':11, 'Dec':12})
help("month.name")
x$Date = month.abb(x$Date)
x$Date = month.abb[x$Date]
View(x)
x = allbikes %>% separate(Date, c("Day", "Date", "Month", "Year"))
x$Month = month.abb[x$Month]
View(x)
tomonthnum = function(x) c(Jan=01, Feb=02, Mar=03, Apr=04, May=05, Jun=06, Jul=07, Aug=08, Sep=09, Oct=10, Nov=11, Dec=12)
map(x$Date, tomonthnum)
x = map(x$Date, tomonthnum)
View(x)
x = allbikes %>% separate(Date, c("Day", "Date", "Month", "Year"))
x$Date = map(x$Date, tomonthnum)
View(x)
tomonthnum = function(x) c(Jan=01, Feb=02, Mar=03, Apr=04, May=05, Jun=06, Jul=07, Aug=08, Sep=09, Oct=10, Nov=11, Dec=12)[tolower(x)]
x = allbikes %>% separate(Date, c("Day", "Date", "Month", "Year"))
x$Date = map(x$Date, tomonthnum)
x = allbikes %>% separate(Date, c("Day", "Date", "Month", "Year"))
x$Month = map(x$Month, tomonthnum)
x = allbikes %>% separate(Date, c("Day", "Date", "Month", "Year"))
x$Month = map(x$Month, tomonthnum)
View(x)
x = allbikes %>% separate(Date, c("Day", "Date", "Month", "Year"))
class(x$Year[1])
tomonthnum = function(x) c(jan=01, Feb=02, Mar=03, Apr=04, May=05, Jun=06, Jul=07, Aug=08, Sep=09, Oct=10, Nov=11, Dec=12)[tolower(x)]
x$Month = map(x$Month, tomonthnum)
View(x)
x$Month = match(x$Month, month.abb)
my_months <- sample(1:12,50, replace = TRUE)
my_months
month.abb[my_months]
my_months_abb <- month.abb[my_months]
my_months_abb
x$Month = (map, match(x$Month, month.abb))
x$Month = map(match(x$Month, month.abb))
x$Month = map(x$Month, match(x$Month, month.abb))
x = allbikes %>% separate(Date, c("Day", "Date", "Month", "Year"))
x$Month = map(x$Month, match(x$Month, month.abb))
my_months_number <- match(my_months_abb,month.abb)
my_months_number
month.abb
moy_months.abb
my_months.abb
my_months_abb <- month.abb[my_months]
my_months_abb
help("match")
class(x$Month   )
class(x$Month)
typeof(x$Month)
x$Month
x$Month = match(x$Month, month.abb)
View(rain_data)
View(x)
x$Month[x$Month == '1']
x$Month[x$Month == '1'] == '01'
x$Month[x$Month == '1'] = '01'
x$Month[x$Month == '1'] = '01'
x$Month[x$Month == c('1','2')] = c('01','02')
View(x)
x = allbikes %>% separate(Date, c("Day", "Date", "Month", "Year"))
x$Month = match(x$Month, month.abb)
x$Month[x$Month == c('1')]
x$Month[x$Month == c('1','2')] = c('01','02')
x$Month[x$Month == c('1','2')] = c('01','02')
x = allbikes %>% separate(Date, c("Day", "Date", "Month", "Year"))
x$Month = match(x$Month, month.abb)
x$Month[x$Month == '1'] = '01'
x$Month[x$Month == '2'] = '02'
x$Month[x$Month == '3'] = '03'
x$Month[x$Month == '4'] = '04'
x$Month[x$Month == '5'] = '05'
x$Month[x$Month == '6'] = '06'
x$Month[x$Month == '7'] = '07'
x$Month[x$Month == '8'] = '08'
x$Month[x$Month == '9'] = '09'
help("formatC")
x = allbikes %>% separate(Date, c("Day", "Date", "Month", "Year"))
x$Month = match(x$Month, month.abb)
View(x)
sprintf("%02d",x$Month)
x$Month = sprintf("%02d",x$Month)
x$Date = sprintf("%02d", x$Date)
class(x$Date[1])
class(x$Month[1])
x$Date = sprintf("%02d", x$Date)
x = allbikes %>% separate(Date, c("Day", "Date", "Month", "Year"))
x$Month = match(x$Month, month.abb)
x$Month = sprintf("%02d",x$Month)
x$Date = sprintf("%02d", x$Date)
x$Date = sprintf("%02s", x$Date)
x$Date = sprintf("%02s", x$Date)
x$Date = sprintf("%02d",x$Date)
View(x)
x = allbikes %>% separate(Date, c("Day", "Date", "Month", "Year"))
x$Month = match(x$Month, month.abb)
typeof(x$Month)
typeof(x$Date)
x$Date = as.integer(x$Date)
typeof(x$Date)
x$Date = as.integer(x$Date)
rain_files = list.files(path = '.', pattern = '.txt', full = TRUE)
rain_data = map(rain_files, read_csv)
rain_data = bind_rows(rain_data)[c(-5,-6)]
x$Month = sprintf("%02d",x$Month)
x$Date = as.integer(x$Date)
x$Date = sprintf("%02d",x$Date)
x = allbikes %>% separate(Date, sep = c('Day','Date','Month','Year'))
x = allbikes %>% separate(Date, c('Day','Date','Month','Year'))
View(x)
x$Month = sprintf("%02d",x$Month)
x$Date = as.integer(x$Date)
x$Date = sprintf("%02d",x$Date)
x$Month = match(x$Month, month.abb)
x = allbikes %>% separate(Date, c('Day','Date','Month','Year'))
x$Month = match(x$Month, month.abb)
x$Month = sprintf("%02d",x$Month)
x$Date = as.integer(x$Date)
x$Date = sprintf("%02d",x$Date)
rain_data %>% group_by(`Date(NZST)`) %>% summarise(sum(Amount(mm)))
rain_data %>% group_by(`Date(NZST)`) %>% summarise(sum('Amount(mm)'))
rain_data %>% group_by(`Date(NZST)`) %>% summarise(sum("Amount(mm"))
rain_data %>% group_by(`Date(NZST)`) %>% summarise(sum("Amount(mm)"))
rain_data %>% group_by("Date(NZST)"") %>% summarise(sum("Amount(mm)"))
date["Amount(mm)"]
rain_data["Amount(mm)"]
rain_data["Amount(mm)"] = rain_data["Amount"]
colnames(rain_data) = c("Station", "Date", "Time", "Amount")
View(rain_data)
rain_data %>% group_by(Date) %>% summarise(sum(Amount))
rain_data = bind_rows(rain_data)[c(-5,-6)]
colnames(rain_data) = c("Station", "Date", "Time", "Amount")
daily_rain = rain_data %>% group_by(Date) %>% summarise(sum(Amount))
View(daily_rain)
x = allbikes %>% separate(Date, c('Day','Date','Month','Year'))
x$Month = match(x$Month, month.abb)
x$Month = sprintf("%02d",x$Month)
x$Date = as.integer(x$Date)
x$Date = sprintf("%02d",x$Date)
x %>% mutate(Date = paste(Year,Month,Date))
x = x %>% mutate(Date = paste(Year,Month,Date))
View(x)
View(x)
x$Date[1]
gsub(" ", "", x$Date[1], fixed = TRUE)
x$Date = gsub(" ", "", x$Date, fixed = TRUE)
x = allbikes %>% separate(Date, c('Day','Dateth','Month','Year'))
x$Month = match(x$Month, month.abb)
x$Month = sprintf("%02d",x$Month)
x$Date = as.integer(x$Date)
x$Date = sprintf("%02d",x$Date)
x = x %>% mutate(Date = paste(Year,Month,Dateth))
x$Date = gsub(" ", "", x$Date, fixed = TRUE)
bike_files = list.files(path = "." ,pattern=".csv",full=TRUE)
bike_data = map(bike_files,read_csv)
notallNA<-function(x) !all(is.na(x))
bike_data <- map(bike_data, select_if, notallNA)
bike_tidy<-map(bike_data, gather, value="rider_count", key="counter", -Date)
allbikes<-bind_rows(bike_tidy)
allbikes = allbikes %>% filter(!is.na(Date))
# bike data - work with x
x = allbikes %>% separate(Date, c('Day','Dateth','Month','Year'))
x$Month = match(x$Month, month.abb)
x$Month = sprintf("%02d",x$Month)
x$Date = as.integer(x$Date)
x$Date = sprintf("%02d",x$Date)
x = x %>% mutate(Date = paste(Year,Month,Dateth))
x$Date = gsub(" ", "", x$Date, fixed = TRUE)
bike_files = list.files(path = "." ,pattern=".csv",full=TRUE)
bike_data = map(bike_files,read_csv)
notallNA<-function(x) !all(is.na(x))
bike_data <- map(bike_data, select_if, notallNA)
bike_tidy<-map(bike_data, gather, value="rider_count", key="counter", -Date)
allbikes<-bind_rows(bike_tidy)
allbikes = allbikes %>% filter(!is.na(Date))
# bike data - work with x
x = allbikes %>% separate(Date, c('Day','Dateth','Month','Year'))
x$Month = match(x$Month, month.abb)
x$Month = sprintf("%02d",x$Month)
x$Dateth = as.integer(x$Dateth)
x$Dateth = sprintf("%02d",x$Dateth)
x = x %>% mutate(Date = paste(Year,Month,Dateth))
x$Date = gsub(" ", "", x$Date, fixed = TRUE)
daily_bike = x %>% group_by(Date) %>% summarise(sum(rider_count))
View(daily_bike)
daily_bike = x %>% group_by(Date) %>% summarise(total_daily_riders = sum(rider_count))
View(daily_bike)
daily_rain = rain_data %>% group_by(Date) %>% summarise(total_daily_rain = sum(Amount))
daily_bike = x %>% group_by(Date) %>% summarise(total_daily_riders = sum(rider_count))
View(daily_bike)
View(allbikes)
View(x)
daily_bike = x %>% group_by(Date) %>% summarise(total_daily_riders = sum(rider_count, na.rm = TRUE))
View(daily_bike)
View(daily_bike)
View(daily_rain)
daily_rain = daily_rain[-1097,]
# column bind daily_bike and daily_rain
bind_cols(daily_bike,daily_rain)
# column bind daily_bike and daily_rain
bind_cols(daily_bike,daily_rain, Date)
inner_join(daily_bike, daily_rain, by = Date)
inner_join(daily_bike, daily_rain, by = 'Date')
typeof(daily_bike$Date)
daily_bike$Date = as.integer(daily_bike$Date)
# column bind daily_bike and daily_rain
inner_join(daily_bike, daily_rain, by = Date)
# column bind daily_bike and daily_rain
inner_join(daily_bike, daily_rain, by = "Date")
# column bind daily_bike and daily_rain
daily_both = inner_join(daily_bike, daily_rain, by = "Date")
View(daily_both)
# plot of bike riders over time
daily_bike %>% plot(Date, total_dadily_riders)
# plot of bike riders over time
plot(daily_bike$Date, daily_bike$total_dadily_riders)
# plot of bike riders over time
as.Date(daily_bike$Date)
x = allbikes %>% separate(Date, c('Day','Dateth','Month','Year'))
x$Month = match(x$Month, month.abb)
x$Month = sprintf("%02d",x$Month)
x$Dateth = as.integer(x$Dateth)
x$Dateth = sprintf("%02d",x$Dateth)
x = x %>% mutate(Date = paste(Year,Month,Dateth))
x$Date = gsub(" ", "", x$Date, fixed = TRUE)
daily_bike = x %>% group_by(Date) %>% summarise(total_daily_riders = sum(rider_count, na.rm = TRUE))
daily_bike$Date = as.Date(daily_bike$Date)
x = allbikes %>% separate(Date, c('Day','Dateth','Month','Year'))
x$Month = match(x$Month, month.abb)
x$Month = sprintf("%02d",x$Month)
x$Dateth = as.integer(x$Dateth)
x$Dateth = sprintf("%02d",x$Dateth)
x = x %>% mutate(Date = paste(Year,Month,Dateth))
x$Date = gsub(" ", "", x$Date, fixed = TRUE)
daily_bike = x %>% group_by(Date) %>% summarise(total_daily_riders = sum(rider_count, na.rm = TRUE))
daily_bike$Date = as.integer(daily_bike$Date)
# plot of bike riders over time
plot(daily_both$Date, daily_both$total_daily_riders)
# plot of bike riders over time
daily_both$Date = as.Date(daily_both$Date, "%Y%m%d")
plot(daily_both$Date, daily_both$total_daily_riders)
# plot of bike riders over time
daily_both$Date = as.Date(daily_both$Date, "%Y%m%d")
# plot of bike riders over time
daily_both$Date = as.Date(daily_both$Date, "%YYYY%mm%dd")
# plot of bike riders over time
daily_both$Date = as.Date(daily_both[["Date"]], "%YYYY%mm%dd")
# plot of bike riders over time
daily_both$Date = as.Date(daily_both[["Date"]], "%Y%m%d")
# plot of bike riders over time
daily_both$Date = as.Date(daily_both[["Date"]], "%Y%m%d")
y = as.Date(daily_both[["Date"]], "%Y%m%d")
# plot of bike riders over time
daily_both$Date = as.character(daily_both$Date)
daily_bike$Date = as.Date(daily_both[["Date"]], "%Y%m%d")
View(daily_both)
class(daily_both$Date)
daily_bike$Date = as.Date(daily_both$Date, "%Y%m%d")
daily_both$Date = as.Date(daily_both$Date, "%Y%m%d")
class(daily_both$Date)
View(daily_both)
plot(daily_both$Date, daily_both$total_daily_riders)
plot(daily_both$Date, daily_both$total_daily_riders, type = 'l')
View(daily_both)
plot.ts(daily_both$Date, daily_both$total_daily_riders)
plot.ts(Date, daily_both$total_daily_riders)
plot.ts(daily_both$Date, daily_both$total_daily_riders)
plot(daily_both$Date, daily_both$total_daily_riders)
library(ggplot2)
library('ggplot2')
ggplot(data = daily_both, aes(x = Date, y = total_daily_riders))
ggplot(data = daily_both, aes(x = Date, y = total_daily_riders) + geom_line(colour = 'red', size = 2))
ggplot(data = daily_both, aes(x = Date, y = total_daily_riders)) + geom_line(colour = 'red', size = 2))
ggplot(data = daily_both, aes(x = Date, y = total_daily_riders))+
geom_line(color = "#00AFBB", size = 2)
ggplot(data = daily_both, aes(x = Date, y = total_daily_riders))+
geom_line(color = "#00AFBB", size = 1)
ggplot(data = daily_both, aes(x = Date, y = total_daily_riders))+
geom_line(color = "#00AFBB", size = 1)
ggplot(data = daily_both, aes(x = Date, y = total_daily_riders))+
geom_line(color = "#00AFBB", size = 0.5)
ggplot(data = daily_both, aes(x = Date, y = total_daily_riders))+
geom_line(color = "#00AFBB", size = 0.01)
View(allbikes)
allbikes %>% group_by(Date) %>% summarise(total = sum(rider_count))
allbikes %>% group_by(Date) %>% summarise(total = sum(rider_count, na.rm = TRUE))
library('tidyverse')
library('refinr')
library('ggplot2')
bike_files = list.files(path = "." ,pattern=".csv",full=TRUE)
bike_data = map(bike_files,read_csv)
notallNA<-function(x) !all(is.na(x))
bike_data <- map(bike_data, select_if, notallNA)
bike_tidy<-map(bike_data, gather, value="rider_count", key="counter", -Date)
allbikes<-bind_rows(bike_tidy)
allbikes = allbikes %>% filter(!is.na(Date))
x = allbikes %>% separate(Date, c('Day','Dateth','Month','Year'))
x$Month = match(x$Month, month.abb)
x$Month = sprintf("%02d",x$Month)
x$Dateth = as.integer(x$Dateth)
x$Dateth = sprintf("%02d",x$Dateth)
x = x %>% mutate(Date = paste(Year,Month,Dateth))
x$Date = gsub(" ", "", x$Date, fixed = TRUE)
daily_bike = x %>% group_by(Date) %>% summarise(total_daily_riders = sum(rider_count, na.rm = TRUE))
daily_bike$Date = as.integer(daily_bike$Date)
# column bind daily_bike and daily_rain
daily_both = inner_join(daily_bike, daily_rain, by = "Date")
# plot of bike riders over time
daily_both$Date = as.character(daily_both$Date)
daily_both$Date = as.Date(daily_both$Date, "%Y%m%d")
ggplot(data = daily_both, aes(x = Date, y = total_daily_riders))+
geom_line(color = "#00AFBB", size = 0.01)
ggplot(data = daily_both, aes(x = Date, y = log(total_daily_riders)))+
geom_line(color = "#00AFBB", size = 0.01)
ggplot(data = daily_both, aes(x = Date, y = total_daily_riders))+
geom_line(color = "#00AFBB", size = 0.01)
library("tidyverse")
log_tib = read_csv("events_log.csv", col_types = 'cccccicii')
log_tib = log_tib %>% separate(timestamp, c('Day', 'Time'), sep = 8)
# Question 1a
test_df = data.frame(Day = c('Mon', 'Mon', 'Mon', 'Mon','Mon', 'Tue','Tue','Tue','Tue', 'Wed','Wed','Wed','Wed'),
session_id = c('a', 'x' ,'y','b','b','c','c','c','c','d','e','f','f'),
action = c('searchPage','checkin' ,'searchPage','searchPage','visitPage', 'searchPage', 'visitPage','searchPage','visitPage','searchPage', 'checkin', 'visitPage','visitPage'))
test_df %>% group_by(Day, action) %>% summarise(n = n_distinct(session_id))
test_df %>% group_by(Day) %>% summarise(n = n_distinct(session_id))
test_df %>% group_by(Day,action) %>% summarise(n = n_distinct(session_id)) %>% filter(action == 'visitPage') %>% print()
# the number of unique session_id's per day
total_unique_sessions = log_tib %>% group_by(Day) %>% summarise(total_sessions = n_distinct(session_id))
total_unique_sessions = total_unique_sessions[-1,] %>% print()
# the number of session_id's that have 'visitpage' per day
unique_sessions_visits = log_tib %>% group_by(Day,action) %>% summarise(visited = n_distinct(session_id)) %>% filter(action == 'visitPage') %>% print()
answer_1a = unique_sessions_visits$visited/total_unique_sessions$total_sessions
# Question 1b
total_unique_sessions_groups = log_tib %>% group_by(Day,group) %>% summarise(total_sessions = n_distinct(session_id))
total_unique_sessions_groups = total_unique_sessions[-1,]
unique_sessions_visits_groups = log_tib %>% group_by(Day,group, action) %>% summarise(visited = n_distinct(session_id)) %>% filter(action == 'visitPage') %>% print()
answer_1b = unique_sessions_visits_groups$visited / total_unique_sessions_groups$total_sessions
# Question 2
first_page_visit_df =
log_tib %>%
group_by(session_id) %>%
arrange(desc(Time), .by_group = TRUE) %>%
filter(action == 'visitPage')%>%
group_by(session_id) %>%
summarise(first_page_position = first(result_position)) %>%
group_by(first_page_position) %>%
summarise(count = n()) %>%
mutate(proportion = count / sum(count))
first_page_visit_df =
log_tib %>%
group_by(session_id) %>%
arrange(desc(Time), .by_group = TRUE) %>%
filter(action == 'visitPage')%>%
group_by(session_id) %>%
summarise(first_page_position = first(result_position)) %>%
group_by(first_page_position) %>%
summarise(count = n()) %>%
mutate(proportion = count / sum(count))
log_tib = log_tib %>% separate(timestamp, c('Day', 'Time'), sep = 8)
log_tib = read_csv("events_log.csv", col_types = 'cccccicii')
setwd("~/github/stats-369/Lab-1")
library("tidyverse")
log_tib = read_csv("events_log.csv", col_types = 'cccccicii')
log_tib = log_tib %>% separate(timestamp, c('Day', 'Time'), sep = 8)
# Question 1a
test_df = data.frame(Day = c('Mon', 'Mon', 'Mon', 'Mon','Mon', 'Tue','Tue','Tue','Tue', 'Wed','Wed','Wed','Wed'),
session_id = c('a', 'x' ,'y','b','b','c','c','c','c','d','e','f','f'),
action = c('searchPage','checkin' ,'searchPage','searchPage','visitPage', 'searchPage', 'visitPage','searchPage','visitPage','searchPage', 'checkin', 'visitPage','visitPage'))
test_df %>% group_by(Day, action) %>% summarise(n = n_distinct(session_id))
test_df %>% group_by(Day) %>% summarise(n = n_distinct(session_id))
test_df %>% group_by(Day,action) %>% summarise(n = n_distinct(session_id)) %>% filter(action == 'visitPage') %>% print()
# the number of unique session_id's per day
total_unique_sessions = log_tib %>% group_by(Day) %>% summarise(total_sessions = n_distinct(session_id))
total_unique_sessions = total_unique_sessions[-1,] %>% print()
# the number of session_id's that have 'visitpage' per day
unique_sessions_visits = log_tib %>% group_by(Day,action) %>% summarise(visited = n_distinct(session_id)) %>% filter(action == 'visitPage') %>% print()
answer_1a = unique_sessions_visits$visited/total_unique_sessions$total_sessions
# Question 1b
total_unique_sessions_groups = log_tib %>% group_by(Day,group) %>% summarise(total_sessions = n_distinct(session_id))
total_unique_sessions_groups = total_unique_sessions[-1,]
unique_sessions_visits_groups = log_tib %>% group_by(Day,group, action) %>% summarise(visited = n_distinct(session_id)) %>% filter(action == 'visitPage') %>% print()
answer_1b = unique_sessions_visits_groups$visited / total_unique_sessions_groups$total_sessions
# Question 2
first_page_visit_df =
log_tib %>%
group_by(session_id) %>%
arrange(desc(Time), .by_group = TRUE) %>%
filter(action == 'visitPage')%>%
group_by(session_id) %>%
summarise(first_page_position = first(result_position)) %>%
group_by(first_page_position) %>%
summarise(count = n()) %>%
mutate(proportion = count / sum(count))
answer_1a = inner_join(unique_sessions_visits, total_unique_sessions, by = Day)
answer_1a = inner_join(unique_sessions_visits, total_unique_sessions, by = 'Day')
View(answer_1a)
answer_1a%>%mutate(Clickthrough rate = visited/total_sessions)
answer_1a %> %mutate(Clickthrough_rate = visited/total_sessions)
answer_1a %>% mutate(Clickthrough_rate = visited/total_sessions)
# Question 1b
total_unique_sessions_groups = log_tib %>% group_by(Day,group) %>% summarise(total_sessions = n_distinct(session_id))
total_unique_sessions_groups = total_unique_sessions[-1,]
unique_sessions_visits_groups = log_tib %>% group_by(Day,group, action) %>% summarise(visited = n_distinct(session_id)) %>% filter(action == 'visitPage') %>% print()
total_unique_sessions_groups
total_unique_sessions_groups = total_unique_sessions[-1,]
# Question 1b
total_unique_sessions_groups = log_tib %>% group_by(group,Day) %>% summarise(total_sessions = n_distinct(session_id))
total_unique_sessions_groups = total_unique_sessions[-1,]
# Question 1b
total_unique_sessions_groups = log_tib %>% group_by(group,Day) %>% summarise(total_sessions = n_distinct(session_id)) %>% View()
total_unique_sessions_groups = total_unique_sessions[-1,] %>% print()
# Question 1b
total_unique_sessions_groups = log_tib %>% group_by(group,Day) %>% summarise(total_sessions = n_distinct(session_id))
total_unique_sessions_groups = total_unique_sessions[-1,] %>% print()
# Question 1b
total_unique_sessions_groups = log_tib %>% group_by(group,Day) %>% summarise(total_sessions = n_distinct(session_id))
# Question 1b
total_unique_sessions_groups = log_tib %>% group_by(group,Day) %>% summarise(total_sessions = n_distinct(session_id)) %>% print()
total_unique_sessions_groups = total_unique_sessions_groups[-1,] %>% print()
unique_sessions_visits_groups = log_tib %>% group_by(Day,group, action) %>% summarise(visited = n_distinct(session_id)) %>% filter(action == 'visitPage') %>% print()
answer_1b = inner_join(total_unique_sessions, unique_sessions_visits_groups, by = 'group')
answer_1b = inner_join(total_unique_sessions, unique_sessions_visits_groups, by = 'group')
answer_1b = unique_sessions_visits_groups$visited / total_unique_sessions_groups$total_sessions
answer_1b
answer_1b
answer_1b = inner_join(total_unique_sessions, unique_sessions_visits_groups, by = 'group')
answer_1b = inner_join(total_unique_sessions, unique_sessions_visits_groups, by = 'group')
answer_1b = inner_join(total_unique_sessions, unique_sessions_visits_groups, by = group)
answer_1b = inner_join(total_unique_sessions, unique_sessions_visits_groups, by = 'group')
View(total_unique_sessions_groups)
View(unique_sessions_visits_groups)
answer_1b = inner_join(total_unique_sessions, unique_sessions_visits_groups, by = 'group, Day')
View(daily_bike)
View(daily_rain)
unique_sessions_visits_groups = unique_sessions_visits_groups[,c('group','Day','action','visited')]
answer_1b = inner_join(total_unique_sessions, unique_sessions_visits_groups, by = 'group, Day')
answer_1b = inner_join(total_unique_sessions, unique_sessions_visits_groups, by = 'group')
unique_sessions_visits_groups = unique_sessions_visits_groups[,c('group','Day','action','visited')] %>% arrange(group)
answer_1b = inner_join(total_unique_sessions, unique_sessions_visits_groups, by = 'group')
answer_1b = inner_join(total_unique_sessions_groups, unique_sessions_visits_groups, by = 'group')
View(answer_1b)
unique_sessions_visits_groups = unique_sessions_visits_groups[,c('group','Day','action','visited')]
answer_1b = inner_join(total_unique_sessions_groups, unique_sessions_visits_groups, by = 'group')
answer_1b = inner_join(total_unique_sessions_groups, unique_sessions_visits_groups, by = 'group')
View(answer_1b)
answer_1b = inner_join(unique_sessions_visits_groups, total_unique_sessions_groups, by = 'Day')
View(answer_1b)
answer_1b = inner_join(unique_sessions_visits_groups, total_unique_sessions_groups, by = 'Day,group')
answer_1b = inner_join(unique_sessions_visits_groups, total_unique_sessions_groups, by = c("Day","group"))
answer_1b %>% mutate(Proportion = visited/total_sessions)
answer_1b %>% mutate(Proportion = visited/total_sessions) %>% arrange(Day)
View(answer_1a)
