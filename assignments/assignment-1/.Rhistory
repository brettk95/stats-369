mean_seasonal$Season = factor(mean_seasonal$Season, levels = c("summer","autmn", "winter", "spring"))
mean_seasonal
mean_seasonal$Season = factor(mean_seasonal$Season, levels = c("summer","autumn", "winter", "spring"))
mean_seasonal
seasonal = seasonal %>% mutate(Season = ifelse(month == "12"|month=="01"|month=="02", "summer",
ifelse(month=="03"|month=="04"|month=="05", "autumn",
ifelse(month=="06"|month=="07"|month=="08", "winter",
ifelse(month=="09"|month=="10"|month=="11", "spring", NA)))))
mean_seasonal = seasonal %>% group_by(year, Season) %>% summarise(mean_cyclists = mean(total_daily_riders, na.rm = T),
mean_rain = mean(total_daily_rain, na.rm = T)) %>% arrange(desc(mean_cyclists))
mean_seasonal$Season = factor(mean_seasonal$Season, levels = c("summer","autumn", "winter", "spring"))
mean_seasonal
mean_seasonal = seasonal %>% group_by(year, Season) %>% summarise(mean_cyclists = mean(total_daily_riders, na.rm = T),
mean_rain = mean(total_daily_rain, na.rm = T)) %>% arrange(desc(mean_cyclists)) %>%
arrange(desc(year))
mean_seasonal
seasonal = seasonal %>% mutate(Season = ifelse(month == "12"|month=="01"|month=="02", "summer",
ifelse(month=="03"|month=="04"|month=="05", "autumn",
ifelse(month=="06"|month=="07"|month=="08", "winter",
ifelse(month=="09"|month=="10"|month=="11", "spring", NA)))))
mean_seasonal = seasonal %>% group_by(year, Season) %>% summarise(mean_cyclists = mean(total_daily_riders, na.rm = T),
mean_rain = mean(total_daily_rain, na.rm = T)) %>% arrange(desc(mean_cyclists)) %>%
arrange(year)
mean_seasonal = seasonal %>% group_by(year, Season) %>% summarise(mean_cyclists = mean(total_daily_riders, na.rm = T),
mean_rain = mean(total_daily_rain, na.rm = T)) %>% arrange(desc(mean_cyclists)) %>%
arrange(year) %>% View()
mean_seasonal$Season = factor(mean_seasonal$Season, levels = c("summer","autumn", "winter", "spring"))
View(mean_seasonal)
mean_seaonsal
mean_seasonal
mean_seasonal = seasonal %>% group_by(year, Season) %>% summarise(mean_cyclists = mean(total_daily_riders, na.rm = T),
mean_rain = mean(total_daily_rain, na.rm = T)) %>% arrange(desc(mean_cyclists)) %>%
arrange(year) %>% View()
mean_seasonal
mean_seasonal = seasonal %>% group_by(year, Season) %>% summarise(mean_cyclists = mean(total_daily_riders, na.rm = T),
mean_rain = mean(total_daily_rain, na.rm = T)) %>% arrange(desc(mean_cyclists)) %>% arrange(year)
seasonal = seasonal %>% mutate(Season = ifelse(month == "12"|month=="01"|month=="02", "summer",
ifelse(month=="03"|month=="04"|month=="05", "autumn",
ifelse(month=="06"|month=="07"|month=="08", "winter",
ifelse(month=="09"|month=="10"|month=="11", "spring", NA)))))
mean_seasonal = seasonal %>% group_by(year, Season) %>% summarise(mean_cyclists = mean(total_daily_riders, na.rm = T),
mean_rain = mean(total_daily_rain, na.rm = T)) %>% arrange(desc(mean_cyclists)) %>% arrange(year)
mean_seasonal
mean_seasonal = seasonal %>% group_by(year, Season) %>% summarise(mean_cyclists = mean(total_daily_riders, na.rm = T),
mean_rain = mean(total_daily_rain, na.rm = T)) %>% arrange(desc(mean_cyclists)) %>% arrange(year, Season)
mean_seasonal = seasonal %>% group_by(year, Season) %>% summarise(mean_cyclists = mean(total_daily_riders, na.rm = T),
mean_rain = mean(total_daily_rain, na.rm = T)) %>% arrange(desc(mean_cyclists)) %>% arrange(year, Season) %>% View()
mean_seasonal = seasonal %>% group_by(year, Season) %>% summarise(mean_cyclists = mean(total_daily_riders, na.rm = T),
mean_rain = mean(total_daily_rain, na.rm = T)) %>%
mutate(Season = factor(Season, levels = c("summer", "autumn", "winter", "spring"))) %>%
arrange(desc(mean_cyclists)) %>% arrange(year, Season) %>% View()
plot(x = mean_seasonal$year, y = mean_cyclists)
plot(x = mean_seasonal$year, y = mean_seasonal$mean_cyclists)
plot(x = mean_seasonal$year, y = mean_seasonal$mean_cyclists, xlim = 2016:2018)
plot(x = mean_seasonal$year, y = mean_seasonal$mean_cyclists)
ggplot(data = mean_seasonal, aes(x = year, y = mean_cyclists))
ggplot(data = mean_seasonal, aes(x = Year, y = mean_cyclists))
seasonal = seasonal %>% mutate(Season = ifelse(month == "12"|month=="01"|month=="02", "summer",
ifelse(month=="03"|month=="04"|month=="05", "autumn",
ifelse(month=="06"|month=="07"|month=="08", "winter",
ifelse(month=="09"|month=="10"|month=="11", "spring", NA)))))
mean_seasonal = seasonal %>% group_by(year, Season) %>% summarise(mean_cyclists = mean(total_daily_riders, na.rm = T),
mean_rain = mean(total_daily_rain, na.rm = T)) %>%
mutate(Season = factor(Season, levels = c("summer", "autumn", "winter", "spring"))) %>%
arrange(desc(mean_cyclists)) %>% arrange(year, Season)
View(mean_seasonal)
ggplot(data = mean_seasonal, aes(x = Year, y = mean_cyclists))
ggplot(data = mean_seasonal, aes(x = year, y = mean_cyclists))
geom_points(data = mean_seasonal, aes(x = year, y = mean_cyclists))+
geom_points(data = mean_seasonal, aes(x = year, y = mean_cyclists))
ggplot(data = mean_seasonal, aes(x = year, y = mean_cyclists)) + geom_point()
ggplot(data = mean_seasonal, aes(group = year, x = season, y = mean_cyclists)) + geom_point()
ggplot(data = mean_seasonal, aes(group = year, x = Season, y = mean_cyclists)) + geom_point()
ggplot(data = mean_seasonal, aes(group = Season, x = year, y = mean_cyclists)) + geom_point()
ggplot(data = mean_seasonal, aes(group = Season, x = Season, y = mean_cyclists)) + geom_point()
ggplot(data = mean_seasonal, aes(group = Year, x = Season, y = mean_cyclists)) + geom_point()
ggplot(data = mean_seasonal, aes(group = year, x = Season, y = mean_cyclists)) + geom_point()
ggplot(data = mean_seasonal, aes(group = Season, x = year, y = mean_cyclists)) + geom_point()
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point(aes(group=Season))
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_line(aes(group=Season))
ggplot(data = mean_seasonal, aes(Season,mean_cyclists)) + geom_line(aes(group=year))
class(mean_seasonal)
mean_seasonal = seasonal %>% group_by(year, Season) %>% summarise(mean_cyclists = mean(total_daily_riders, na.rm = T),
mean_rain = mean(total_daily_rain, na.rm = T)) %>%
mutate(Season = factor(Season, levels = c("summer", "autumn", "winter", "spring"))) %>%
arrange(desc(mean_cyclists)) %>% arrange(year, Season) %>% ungroup()
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_line()
mean_seasonal = seasonal %>% group_by(year, Season) %>% summarise(mean_cyclists = mean(total_daily_riders, na.rm = T),
mean_rain = mean(total_daily_rain, na.rm = T)) %>%
mutate(Season = factor(Season, levels = c("summer", "autumn", "winter", "spring"))) %>%
arrange(desc(mean_cyclists)) %>% arrange(year, Season) %>% ungroup()
mean_seasonal
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_points()
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point()
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point(group = year)
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point(aes(group = year))
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point(aes(group = Season))
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point(aes(group = mean_rain))
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point()
# plot seasonal data
seasonal = daily_both %>% separate(Date, c("year","month","day"), sep = '-') %>% group_by(month)
seasonal = seasonal %>% mutate(Season = ifelse(month == "12"|month=="01"|month=="02", "summer",
ifelse(month=="03"|month=="04"|month=="05", "autumn",
ifelse(month=="06"|month=="07"|month=="08", "winter",
ifelse(month=="09"|month=="10"|month=="11", "spring", NA)))))
mean_seasonal = seasonal %>% group_by(year, Season) %>% summarise(mean_cyclists = mean(total_daily_riders, na.rm = T),
mean_rain = mean(total_daily_rain, na.rm = T)) %>%
mutate(Season = factor(Season, levels = c("summer", "autumn", "winter", "spring"))) %>%
arrange(desc(mean_cyclists)) %>% arrange(year, Season) %>% ungroup()
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point()
View(mean_seasonal)
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point(aes(group = c(year,Season)))
mean_seasonal = seasonal %>% group_by(year, Season) %>% summarise(mean_cyclists = mean(total_daily_riders, na.rm = T),
mean_rain = mean(total_daily_rain, na.rm = T)) %>%
mutate(Season = factor(Season, levels = c("summer", "autumn", "winter", "spring"))) %>%
arrange(desc(mean_cyclists)) %>% arrange(year, Season)
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point(aes(group = c(Season)))
mean_seasonal$Season = as.Date(mean_seasonal$Season)
mean_seasonal = seasonal %>% group_by(year, Season) %>% summarise(mean_cyclists = mean(total_daily_riders, na.rm = T),
mean_rain = mean(total_daily_rain, na.rm = T)) %>%
mutate(Season = factor(Season, levels = c("summer", "autumn", "winter", "spring"))) %>%
arrange(desc(mean_cyclists)) %>% arrange(year, Season)
mean_seasonal = seasonal %>% group_by(year, Season) %>% summarise(mean_cyclists = mean(total_daily_riders, na.rm = T),
mean_rain = mean(total_daily_rain, na.rm = T)) %>%
mutate(Season = factor(Season, levels = c("summer", "autumn", "winter", "spring"))) %>%
arrange(desc(mean_cyclists)) %>% arrange(year, Season) %>% View()
print(p)
p = ggplot()+
geom_line(data = weekly_data, aes(x = week, y = total_weekly_riders/100), color = "black")+
geom_line(data = weekly_data, aes(x = week, y = total_weekly_rain), color = "blue")
print(p)
plot(daily_both$Date, daily_both$total_daily_riders)
ggplot(data = daily_both, aes(Date, total_cyclists)) + geom_point(())
ggplot(data = daily_both, aes(Date, total_cyclists)) + geom_point()
View(daily_both)
ggplot(data = daily_both, aes(Date, total_daily_riders)) + geom_point()
# plot over every day
ggplot(data = daily_both, aes(Date, total_daily_riders)) + geom_point()
library('tidyverse')
library('refinr')
library('ggplot2')
bike_files = list.files(path = "." ,pattern=".csv",full=TRUE)
bike_data = map(bike_files,read_csv)
notallNA<-function(x) !all(is.na(x))
bike_data <- map(bike_data, select_if, notallNA)
bike_tidy<-map(bike_data, gather, value="rider_count", key="counter", -Date)
allbikes<-bind_rows(bike_tidy)
allbikes = allbikes %>% filter(!is.na(Date))
# bike data - work with x
x = allbikes %>% separate(Date, c('Day','Dateth','Month','Year'))
x$Month = match(x$Month, month.abb)
x$Month = sprintf("%02d",x$Month)
x$Dateth = as.integer(x$Dateth)
x$Dateth = sprintf("%02d",x$Dateth)
x = x %>% mutate(Date = paste(Year,Month,Dateth))
x$Date = gsub(" ", "", x$Date, fixed = TRUE)
daily_bike = x %>% group_by(Date) %>% summarise(total_daily_riders = sum(rider_count, na.rm = TRUE))
daily_bike$Date = as.integer(daily_bike$Date)
# Read rain data
rain_files = list.files(path = '.', pattern = '.txt', full = TRUE)
rain_data = map(rain_files, read_csv)
rain_data = bind_rows(rain_data)[c(-5,-6)]
colnames(rain_data) = c("Station", "Date", "Time", "Amount")
daily_rain = rain_data %>% group_by(Date) %>% summarise(total_daily_rain = sum(Amount))
daily_rain = daily_rain[-1097,] # remove 1st Jan 2019
# column bind daily_bike and daily_rain
daily_both = inner_join(daily_bike, daily_rain, by = "Date")
daily_both$Date = as.character(daily_both$Date)
daily_both$Date = as.Date(daily_both$Date, "%Y%m%d")
daily_both = daily_both %>% mutate(day_of_week = weekdays(Date))
daily_both["week"] = floor_date(daily_both$Date, "week")
# plot over every day
ggplot(data = daily_both, aes(Date, total_daily_riders)) + geom_point()
# plot over days over time (weekly data)
weekly_data = daily_both %>% group_by(week) %>% summarise(total_weekly_riders = mean(total_daily_riders),
total_weekly_rain = mean(total_daily_rain))
weekly_data = weekly_data[c(-1,-158),]
ggplot()+
geom_line(data = weekly_data, aes(x = week, y = total_weekly_riders/100), color = "black")+
geom_line(data = weekly_data, aes(x = week, y = total_weekly_rain), color = "blue")
# plot over days of the week
day_of_week_data = daily_both %>% group_by(day_of_week) %>% summarise(mean_riders_day = mean(total_daily_riders))
day_of_week_data$day_of_week = factor(day_of_week_data$day_of_week, levels = c("Monday","Tuesday","Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
ggplot(data = day_of_week_data, aes(x = day_of_week, y = mean_riders_day))+
geom_bar(stat = "identity")
# plot seasonal data
seasonal = daily_both %>% separate(Date, c("year","month","day"), sep = '-') %>% group_by(month)
seasonal = seasonal %>% mutate(Season = ifelse(month == "12"|month=="01"|month=="02", "summer",
ifelse(month=="03"|month=="04"|month=="05", "autumn",
ifelse(month=="06"|month=="07"|month=="08", "winter",
ifelse(month=="09"|month=="10"|month=="11", "spring", NA)))))
mean_seasonal = seasonal %>% group_by(year, Season) %>% summarise(mean_cyclists = mean(total_daily_riders, na.rm = T),
mean_rain = mean(total_daily_rain, na.rm = T)) %>%
mutate(Season = factor(Season, levels = c("summer", "autumn", "winter", "spring"))) %>%
arrange(desc(mean_cyclists)) %>% arrange(year, Season) %>% View()
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point(aes(group = c(Season)))
# Fit a regression model to predict number of cyclists from year, season, day of the week, and rain
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point()
mean_seasonal = seasonal %>% group_by(year, Season) %>% summarise(mean_cyclists = mean(total_daily_riders, na.rm = T),
mean_rain = mean(total_daily_rain, na.rm = T)) %>%
mutate(Season = factor(Season, levels = c("summer", "autumn", "winter", "spring"))) %>%
arrange(desc(mean_cyclists)) %>% arrange(year, Season)
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point()
mean_seasonal = seasonal %>%
group_by(year, Season) %>%
summarise(mean_cyclists = mean(total_daily_riders, na.rm = T), mean_rain = mean(total_daily_rain, na.rm = T)) %>%
mutate(Season = factor(Season, levels = c("summer", "autumn", "winter", "spring"))) %>%
arrange(desc(mean_cyclists)) %>%
arrange(year, Season)
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point()
glm(formula = total_daily_riders ~ I(year - 2016), family = "poisson", data = daily_both)
glm(formula = total_daily_riders ~ I(Date - 2016), family = "poisson", data = daily_both)
glm(formula = total_daily_riders ~ I(Date), family = "poisson", data = daily_both)
glm(formula = mean_cyclists ~ Season, family = "poisson", data = mean_seasonal)
warnings()
glm(formula = mean_cyclists ~ Season, data = mean_seasonal)
lm_season = glm(formula = mean_cyclists ~ Season, data = mean_seasonal)
View(lm_season)
lm_season
View(weekly_data)
View(weekly_data)
lm_time = glm(formula = total_weekly_riders ~ week, data = weekly_data, family = "poisson")
warnings()
lm_time
lm_time = glm(formula = total_weekly_riders ~ week, data = weekly_data)
lm_time
View(weekly.data)
View(weekly_data)
I(weekly_data$week - 2016)
I(weekly_data$week - 2000)
library('tidyverse')
library('refinr')
library('ggplot2')
bike_files = list.files(path = "." ,pattern=".csv",full=TRUE)
bike_data = map(bike_files,read_csv)
notallNA<-function(x) !all(is.na(x))
bike_data <- map(bike_data, select_if, notallNA)
bike_tidy<-map(bike_data, gather, value="rider_count", key="counter", -Date)
allbikes<-bind_rows(bike_tidy)
allbikes = allbikes %>% filter(!is.na(Date))
# bike data - work with x
x = allbikes %>% separate(Date, c('Day','Dateth','Month','Year'))
x$Month = match(x$Month, month.abb)
x$Month = sprintf("%02d",x$Month)
x$Dateth = as.integer(x$Dateth)
x$Dateth = sprintf("%02d",x$Dateth)
x = x %>% mutate(Date = paste(Year,Month,Dateth))
x$Date = gsub(" ", "", x$Date, fixed = TRUE)
daily_bike = x %>% group_by(Date) %>% summarise(total_daily_riders = sum(rider_count, na.rm = TRUE))
daily_bike$Date = as.integer(daily_bike$Date)
# Read rain data
rain_files = list.files(path = '.', pattern = '.txt', full = TRUE)
rain_data = map(rain_files, read_csv)
rain_data = bind_rows(rain_data)[c(-5,-6)]
colnames(rain_data) = c("Station", "Date", "Time", "Amount")
daily_rain = rain_data %>% group_by(Date) %>% summarise(total_daily_rain = sum(Amount))
daily_rain = daily_rain[-1097,] # remove 1st Jan 2019
# column bind daily_bike and daily_rain
daily_both = inner_join(daily_bike, daily_rain, by = "Date")
daily_both$Date = as.character(daily_both$Date)
daily_both$Date = as.Date(daily_both$Date, "%Y%m%d")
daily_both = daily_both %>% mutate(day_of_week = weekdays(Date))
daily_both["week"] = floor_date(daily_both$Date, "week")
# plot over every day
ggplot(data = daily_both, aes(Date, total_daily_riders)) + geom_point()
# plot over days over time (weekly data)
weekly_data = daily_both %>% group_by(week) %>% summarise(total_weekly_riders = mean(total_daily_riders),
total_weekly_rain = mean(total_daily_rain))
weekly_data = weekly_data[c(-1,-158),]
ggplot()+
geom_line(data = weekly_data, aes(x = week, y = total_weekly_riders/100), color = "black")+
geom_line(data = weekly_data, aes(x = week, y = total_weekly_rain), color = "blue")
# plot over days of the week
day_of_week_data = daily_both %>% group_by(day_of_week) %>% summarise(mean_riders_day = mean(total_daily_riders))
day_of_week_data$day_of_week = factor(day_of_week_data$day_of_week, levels = c("Monday","Tuesday","Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
ggplot(data = day_of_week_data, aes(x = day_of_week, y = mean_riders_day))+
geom_bar(stat = "identity")
# plot seasonal data
seasonal = daily_both %>% separate(Date, c("year","month","day"), sep = '-') %>% group_by(month)
seasonal = seasonal %>% mutate(Season = ifelse(month == "12"|month=="01"|month=="02", "summer",
ifelse(month=="03"|month=="04"|month=="05", "autumn",
ifelse(month=="06"|month=="07"|month=="08", "winter",
ifelse(month=="09"|month=="10"|month=="11", "spring", NA)))))
mean_seasonal = seasonal %>%
group_by(year, Season) %>%
summarise(mean_cyclists = mean(total_daily_riders, na.rm = T), mean_rain = mean(total_daily_rain, na.rm = T)) %>%
mutate(Season = factor(Season, levels = c("summer", "autumn", "winter", "spring"))) %>%
arrange(desc(mean_cyclists)) %>%
arrange(year, Season)
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point() # this plot is shit
# Fit a regression model to predict number of cyclists from year, season, day of the week, and rain
lm_season = glm(formula = mean_cyclists ~ Season, data = mean_seasonal)
View(daily_both)
View(seasonal)
View(daily_both)
daily_both["week"] = floor_date(daily_both$Date, "week")
library('tidyverse')
library('refinr')
library('lubridate')
library('ggplot2')
bike_files = list.files(path = "." ,pattern=".csv",full=TRUE)
bike_data = map(bike_files,read_csv)
notallNA<-function(x) !all(is.na(x))
bike_data <- map(bike_data, select_if, notallNA)
bike_tidy<-map(bike_data, gather, value="rider_count", key="counter", -Date)
allbikes<-bind_rows(bike_tidy)
allbikes = allbikes %>% filter(!is.na(Date))
# bike data - work with x
x = allbikes %>% separate(Date, c('Day','Dateth','Month','Year'))
x$Month = match(x$Month, month.abb)
x$Month = sprintf("%02d",x$Month)
x$Dateth = as.integer(x$Dateth)
x$Dateth = sprintf("%02d",x$Dateth)
x = x %>% mutate(Date = paste(Year,Month,Dateth))
x$Date = gsub(" ", "", x$Date, fixed = TRUE)
daily_bike = x %>% group_by(Date) %>% summarise(total_daily_riders = sum(rider_count, na.rm = TRUE))
daily_bike$Date = as.integer(daily_bike$Date)
# Read rain data
rain_files = list.files(path = '.', pattern = '.txt', full = TRUE)
rain_data = map(rain_files, read_csv)
rain_data = bind_rows(rain_data)[c(-5,-6)]
colnames(rain_data) = c("Station", "Date", "Time", "Amount")
daily_rain = rain_data %>% group_by(Date) %>% summarise(total_daily_rain = sum(Amount))
daily_rain = daily_rain[-1097,] # remove 1st Jan 2019
# column bind daily_bike and daily_rain
daily_both = inner_join(daily_bike, daily_rain, by = "Date")
daily_both$Date = as.character(daily_both$Date)
daily_both$Date = as.Date(daily_both$Date, "%Y%m%d")
daily_both = daily_both %>% mutate(day_of_week = weekdays(Date))
daily_both["week"] = floor_date(daily_both$Date, "week")
# plot over every day
ggplot(data = daily_both, aes(Date, total_daily_riders)) + geom_point()
# plot over days over time (weekly data)
weekly_data = daily_both %>% group_by(week) %>% summarise(total_weekly_riders = mean(total_daily_riders),
total_weekly_rain = mean(total_daily_rain))
weekly_data = weekly_data[c(-1,-158),]
ggplot()+
geom_line(data = weekly_data, aes(x = week, y = total_weekly_riders/100), color = "black")+
geom_line(data = weekly_data, aes(x = week, y = total_weekly_rain), color = "blue")
# plot over days of the week
day_of_week_data = daily_both %>% group_by(day_of_week) %>% summarise(mean_riders_day = mean(total_daily_riders))
day_of_week_data$day_of_week = factor(day_of_week_data$day_of_week, levels = c("Monday","Tuesday","Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
ggplot(data = day_of_week_data, aes(x = day_of_week, y = mean_riders_day))+
geom_bar(stat = "identity")
# plot seasonal data
seasonal = daily_both %>% separate(Date, c("year","month","day"), sep = '-') %>% group_by(month)
seasonal = seasonal %>% mutate(Season = ifelse(month == "12"|month=="01"|month=="02", "summer",
ifelse(month=="03"|month=="04"|month=="05", "autumn",
ifelse(month=="06"|month=="07"|month=="08", "winter",
ifelse(month=="09"|month=="10"|month=="11", "spring", NA)))))
mean_seasonal = seasonal %>%
group_by(year, Season) %>%
summarise(mean_cyclists = mean(total_daily_riders, na.rm = T), mean_rain = mean(total_daily_rain, na.rm = T)) %>%
mutate(Season = factor(Season, levels = c("summer", "autumn", "winter", "spring"))) %>%
arrange(desc(mean_cyclists)) %>%
arrange(year, Season)
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point() # this plot is shit
# Fit a regression model to predict number of cyclists from year, season, day of the week, and rain
lm_season = glm(formula = mean_cyclists ~ Season, data = mean_seasonal)
View(weekly_data)
View(daily_both)
# plot over days over time (weekly data)
weekly_data = daily_both %>% group_by(week) %>% summarise(mean_weekly_riders = mean(total_daily_riders),
mean_weekly_rain = mean(total_daily_rain))
weekly_data = weekly_data[c(-1,-158),]
View(weekly_data)
weekly_data = weekly_data[c(-1,-158),]
ggplot()+
geom_line(data = weekly_data, aes(x = week, y = total_weekly_riders/100), color = "black")+
geom_line(data = weekly_data, aes(x = week, y = total_weekly_rain), color = "blue")
ggplot()+
geom_line(data = weekly_data, aes(x = week, y = mean_weekly_riders), color = "black")+
geom_line(data = weekly_data, aes(x = week, y = mean_weekly_rain), color = "blue")
ggplot()+
geom_line(data = weekly_data, aes(x = week, y = mean_weekly_riders/1000), color = "black")+
geom_line(data = weekly_data, aes(x = week, y = mean_weekly_rain), color = "blue")
ggplot()+
geom_line(data = weekly_data, aes(x = week, y = mean_weekly_riders/100), color = "black")+
geom_line(data = weekly_data, aes(x = week, y = mean_weekly_rain), color = "blue")
# plot over days of the week
day_of_week_data = daily_both %>% group_by(day_of_week) %>% summarise(mean_riders_day = mean(total_daily_riders))
ggplot(data = day_of_week_data, aes(x = day_of_week, y = mean_riders_day))+
geom_bar(stat = "identity")
View(day_of_week_data)
day_of_week_data$day_of_week = factor(day_of_week_data$day_of_week, levels = c("Monday","Tuesday","Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
ggplot(data = day_of_week_data, aes(x = day_of_week, y = mean_riders_day))+
geom_bar(stat = "identity")
View(day_of_week_data)
View(day_of_week_data)
day_of_week_data
day_of_week_data %>% arrange(day_of_week)
# plot seasonal data
seasonal = daily_both %>% separate(Date, c("year","month","day"), sep = '-') %>% group_by(month)
seasonal = seasonal %>% mutate(Season = ifelse(month == "12"|month=="01"|month=="02", "summer",
ifelse(month=="03"|month=="04"|month=="05", "autumn",
ifelse(month=="06"|month=="07"|month=="08", "winter",
ifelse(month=="09"|month=="10"|month=="11", "spring", NA)))))
View(seasonal)
View(seasonal)
# plot over every day
ggplot(data = daily_both, aes(Date, total_daily_riders)) + geom_point()
# plot over days over time (weekly data) - "mean" here means the "mean total daily riders"
weekly_data = daily_both %>% group_by(week) %>% summarise(mean_weekly_riders = mean(total_daily_riders),
mean_weekly_rain = mean(total_daily_rain))
View(weekly_data)
View(daily_both)
ggplot(data = day_of_week_data, aes(x = day_of_week, y = mean_riders_day))+
geom_bar(stat = "identity")
help(ggseasonplot)
help(ggseasonplot)
ggseasonplot(mean_seasonal)
help(ggplot)
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point() # this plot is shit
seasonplot(mean_seasonal)
seasonal['Date'] = c(seasonal$year, seasonal$month, seasonal$day)
View(seasonal)
seasonal = seasonal[,c(year,month,day)]
head(seasonal)
seasonal = seasonal[,c(year,month,day)]
seasonal = seasonal[,c('year','month','day')]
View(seasonal)
# plot seasonal data
seasonal = daily_both %>% separate(Date, c("year","month","day"), sep = '-') %>% group_by(month)
seasonal = seasonal %>% mutate(Season = ifelse(month == "12"|month=="01"|month=="02", "summer",
ifelse(month=="03"|month=="04"|month=="05", "autumn",
ifelse(month=="06"|month=="07"|month=="08", "winter",
ifelse(month=="09"|month=="10"|month=="11", "spring", NA)))))
unite(seasonal, col = "date", c(year, month, day))
unite(seasonal, col = "date", c(year, month, day), sep = "")
View(seasonal)
seasonal = unite(seasonal, col = "date", c(year, month, day), sep = "")
View(seasonal)
mean_seasonal = seasonal %>%
group_by(year, Season) %>%
summarise(mean_cyclists = mean(total_daily_riders, na.rm = T), mean_rain = mean(total_daily_rain, na.rm = T)) %>%
mutate(Season = factor(Season, levels = c("summer", "autumn", "winter", "spring"))) %>%
arrange(desc(mean_cyclists)) %>%
arrange(year, Season)
mean_seasonal = seasonal %>%
group_by(year, Season) %>%
summarise(mean_cyclists = mean(total_daily_riders, na.rm = T), mean_rain = mean(total_daily_rain, na.rm = T)) %>%
mutate(Season = factor(Season, levels = c("summer", "autumn", "winter", "spring"))) %>%
arrange(desc(mean_cyclists))
mean_seasonal = seasonal %>%
group_by(Season) %>%
summarise(mean_cyclists = mean(total_daily_riders, na.rm = T), mean_rain = mean(total_daily_rain, na.rm = T)) %>%
mutate(Season = factor(Season, levels = c("summer", "autumn", "winter", "spring"))) %>%
arrange(desc(mean_cyclists))
View(mean_seasonal)
seasonal = seasonal %>% mutate(Season = ifelse(month == "12"|month=="01"|month=="02", "summer",
ifelse(month=="03"|month=="04"|month=="05", "autumn",
ifelse(month=="06"|month=="07"|month=="08", "winter",
ifelse(month=="09"|month=="10"|month=="11", "spring", NA)))))
# plot seasonal data
seasonal = daily_both %>% separate(Date, c("year","month","day"), sep = '-') %>% group_by(month)
seasonal = seasonal %>% mutate(Season = ifelse(month == "12"|month=="01"|month=="02", "summer",
ifelse(month=="03"|month=="04"|month=="05", "autumn",
ifelse(month=="06"|month=="07"|month=="08", "winter",
ifelse(month=="09"|month=="10"|month=="11", "spring", NA)))))
mean_seasonal = seasonal %>%
group_by(year, Season) %>%
summarise(mean_cyclists = mean(total_daily_riders, na.rm = T), mean_rain = mean(total_daily_rain, na.rm = T)) %>%
mutate(Season = factor(Season, levels = c("summer", "autumn", "winter", "spring"))) %>%
arrange(desc(mean_cyclists)) %>%
arrange(year, Season)
View(mean_seasonal)
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point() # this plot is shit
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point(aes(group = Season)) # this plot is shit
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point(aes(group = Year)) # this plot is shit
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point(aes(group = year)) # this plot is shit
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point(aes(group = Season)) # this plot is shit
View(mean_seasonal)
# plot seasonal data
seasonal = daily_both %>% separate(Date, c("year","month","day"), sep = '-') %>% group_by(month)
seasonal = seasonal %>% mutate(season = ifelse(month == "12"|month=="01"|month=="02", "summer",
ifelse(month=="03"|month=="04"|month=="05", "autumn",
ifelse(month=="06"|month=="07"|month=="08", "winter",
ifelse(month=="09"|month=="10"|month=="11", "spring", NA))))) # create seasons
mean_seasonal = seasonal %>%
group_by(year, season) %>%
summarise(mean_cyclists = mean(total_daily_riders, na.rm = T), mean_rain = mean(total_daily_rain, na.rm = T)) %>%
mutate(season = factor(Season, levels = c("summer", "autumn", "winter", "spring"))) %>%
arrange(desc(mean_cyclists)) %>%
arrange(year, season)
mean_seasonal = seasonal %>%
group_by(year, season) %>%
summarise(mean_cyclists = mean(total_daily_riders, na.rm = T), mean_rain = mean(total_daily_rain, na.rm = T)) %>%
mutate(season = factor(season, levels = c("summer", "autumn", "winter", "spring"))) %>%
arrange(desc(mean_cyclists)) %>%
arrange(year, season)
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_point(aes(group = season)) # this plot is shit
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_line(aes(group = season)) # this plot is shit
ggplot(data = mean_seasonal, aes(year,mean_cyclists)) + geom_line(aes(group = year)) # this plot is shit
ggplot(data = mean_seasonal, aes(season,mean_cyclists)) + geom_line(aes(group = year)) # this plot is shit
ggplot(data = mean_seasonal, aes(season,mean_cyclists)) + geom_bar(aes(group = year)) # this plot is shit
ggplot(data = mean_seasonal, aes(season,mean_cyclists)) + geom_hist(aes(group = year)) # this plot is shit
ggplot(data = mean_seasonal, aes(season,mean_cyclists)) + geom_col(aes(group = year)) # this plot is shit
ggplot(data = mean_seasonal, aes(season,mean_cyclists)) + geom_line(aes(group = year)) # this plot is shit
ggplot(data = mean_seasonal, aes(season,mean_cyclists)) + geom_line(aes(group = year), label = T) # this plot is shit
View(seasonal)
ggplot(data = mean_seasonal, aes(season,mean_cyclists)) +
geom_line(aes(group = year), label = T) +
labs(y = "mean daily cyclists over season", x = "season")# this plot is shit
ggplot(data = mean_seasonal, aes(season,mean_cyclists, group = year)) +
geom_line() +
labs(y = "mean daily cyclists over season", x = "season")# this plot is shit
ggplot(data = mean_seasonal, aes(season,mean_cyclists)) +
geom_line() +
labs(y = "mean daily cyclists over season", x = "season")# this plot is shit
ggplot(data = mean_seasonal, aes(season,mean_cyclists, group = year)) +
geom_line() +
labs(y = "mean daily cyclists over season", x = "season")# this plot is shit
